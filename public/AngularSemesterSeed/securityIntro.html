<!DOCTYPE html>
<html>
<head>
  <title>Node-Intro</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!--<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.13/angular.min.js"></script>-->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" media="all" href="../theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="../theme/css/phone.css">
  <script src="../angular/angular.min.js"></script>
  <script src="https://code.angularjs.org/1.2.18/i18n/angular-locale_da.js"></script>

  <script src="../js/jquery-1.11.1.min.js"></script>
  <script src="../js/presenter.js"></script>

  <base target="_blank">

  <!-- This opens all links in a new tab. -->
  <script data-main="../js/slides" src="../js/require-1.0.8.min.js"></script>
  <!--In order to have more than one slideset in the project-->
  <script src="slides.js"></script>

</head>

<!--Setup Angular for the full slide-set-->
<!--<body ng-app="SlideApp" style="opacity: 0">-->
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground" style="background: #00163B">
    <aside class="gdbar"><img src="../images/logo.png" style="width: 200px;"></aside>
    <hgroup class="auto-fadein" style="color: white;">
      <div style="float: left;">
        <div style="max-width: 20em;">
          <h1 data-config-title></h1>
          <h2 data-config-subtitle></h2>
          <p data-config-presenter></p>
        </div>
      </div>
      <div style="float:left;margin-left: 2em;"><img src="images/logo.png" style="width:300px;"></div>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Structuring Angular Applications 1</h2>
    </hgroup>
    <article>
      <div class="row">
        <div class="col-md-6">
          <p>Up until now (almost) all our JavaScript has been in one file.</p>
          <p>Obviously, that won't hold as soon as things gets just a little bit more complex</p>
          <p>There are many ways to do this. We will let us inspire by the angular-seed</p>
        </div>
        <div class="col-md-6">
          <img style="width:80%;" src="images/backInMyDay.jpg"/>
        </div>
      </div>
    </article>
  </slide>
  <slide>
    <hgroup>
      <h2>Structuring Angular Applications 2</h2>

      <h3>How to structure your code in Angular Applications</h3>
    </hgroup>

    <article>
      <p>An example Seed (inspiration for ours)</p>

      <p><a href="https://github.com/angular/angular-seed">https://github.com/angular/angular-seed</a></p>

      <p>Using Modules</p>

      <p><a href="https://docs.angularjs.org/guide/module/#recommended-setup">https://docs.angularjs.org/guide/module/#recommended-setup</a>
      </p>
    </article>

  </slide>

  <slide>
    <hgroup>
      <h2>REST, SPA's and Security</h2>
    </hgroup>

    <article>
      <img style="margin:3em;width:55%;" src="images/oath.png">

    </article>

  </slide>

  <slide>
    <hgroup>
      <h2>Cookies vs Tokens</h2>

      <h3> Getting auth right with Angular.JS</h3>
    </hgroup>

    <article>
      <img style="margin-top: -30px;width:95%;" src="images/cookie-token-auth.png">

      <p style="font-size: 0.8em;"><a
              href="https://auth0.com/blog/2014/01/07/angularjs-authentication-with-cookies-vs-token/">
        https://auth0.com/blog/2014/01/07/angularjs-authentication-with-cookies-vs-token/</a></p>
    </article>

  </slide>
  <slide>
    <hgroup>
      <h2>Token based auth</h2>

      <h3> Using Json Web Tokens</h3>
    </hgroup>

    <article>
      <img style="margin-top: -35px;margin-left:5%;width:72%;" src="images/jsonwebtoken.png">

      <p style="font-size: 0.8em;"><a href="http://scytl.github.io/restguide/#_security">
        http://scytl.github.io/restguide/#_security</a></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>JSON Web Tokens</h2>
    </hgroup>
    <article>
      <p>
        JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for
        securely
        transmitting information between parties as a JSON object.
      <p>
      <p>This information can be verified and trusted because it is digitally signed.</p>
      <p>JWTs can be signed using a secret (with the HMAC algorithm) or a public/private key pair using RSA</p>
      <p>Benefits</p>
      <ul>
        <li><b>Compact:</b> Because of its smaller size, JWTs can be sent through an URL, POST parameter, or
          inside an
          HTTP header.
        </li>
        <li><b>The payload</b> contains all the required information about the user, avoiding the need to query
          the
          database
          more than once
        </li>
      </ul>
    </article>
  </slide>

  <script>
    function getJwt() {
      $.get("/jwt", function (data) {
        $("#jwtholder").val(data.token.substr(4, data.token.length));
        $("#xx").html(data.token.substr(4, data.token.length));
      })
    }
  </script>

  <slide>
    <hgroup>
      <h2>JSON Web Token structure</h2>
    </hgroup>
    <article>
      <p>Before we go into details, lets see a jwt (jot) for real</p>
      <p>Observer the three sections (separated by dots) in the jwt</p>
      <textarea id="jwtholder" rows="7" cols="70">
      </textarea><br/>
      <button class="btn btn-primary" onclick="getJwt()">Get JWT</button>
      <p style="margin-top: 0.8em;">The token is signed, using the secret <b>MEAN</b></p>
      <p><a href="https://jwt.io/">Copy token to clipboard and lets verify it</a></p>
    </article>
  </slide>


  <slide>
    <hgroup>
      <h2>Are Tokens Secure?</h2>
    </hgroup>
    <article>
      <p style="margin-top:60px;">Everyone with access to the Token can read the content (is that a problem)</p>

      <p>Tokens does not encrypt your payload</p>

      <p style="float:left;">Use TLS to solve this problem</p>
      <img src="images/tls.png">
    </article>
  </slide>
  <slide>
    <hgroup><h2>The Semester Seed</h2></hgroup>
    <article>
      <ul>
        <li>The seed provides support for Token-based Security "Out of the Box"</li>
        <li>It creates a Token on an OK login, and returns the TOKEN to the client with the Login-response</li>
        <li>The client automatically assigns the Token to all outgoing REST-requests</li>
        <li>The Server validates (protected) REST resources up against the sent Token</li>
      </ul>
      <p style="font-size: 1.1em;;color:#000066">SO how much should I care, what do I need to know to use Security
        with the seed?</p>
      <ul>
        <li>Almost nothing :-)</li>
        <li>You can (and should) completely abstract away the security folder on the Server</li>
        <li>You can abstract away the authentication.js file on the Client</li>
      </ul>
      </h2>

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Seed for semester Project</h2>

    </hgroup>
    <article>
      <div style="margin-top: -20px;">
        <p>Semester Seed meant for the exercises today:</p>
        <p><a href="https://github.com/Lars-m/semesterseedfall2016">https://github.com/Lars-m/semesterseedfall2016</a>
        </p>
        <br/>

        <p>The seed ships with <b>Authentication</b> and <b>Authorization</b> almost ready to use, but with a
          hardcoded in-memory User-list.</p>
        <p style="color:#006600">Exercise for today is to replace this with a DataBase and NOT store passwords
          in plain-text
          Read info on the seeds "Using the Seed" page. It's all on one page</p>
        <div style="border:solid 1px slategray;width:100%;height:6px;background-color: slategray;margin-bottom: 20px;">
          &nbsp;</div>
        <div style="float:left;width:30%"><img style="width:70%" src="../images/Demo.png"></div>
        <div style="float: left;font-size: 80%;width: 70%;">
          <ul>
            <li>Clone or Fork the seed</li>
            <li>Open in NetBeans and do "Clean And Build"
            <li>Execute the project and verify that "security works"</li>
            <li>Open the file <code>test. InitialSeedRestIntegrationTest</code> &rightarrow; Right click and do ”Test
              file”
            </li>
          </ul>
        </div>

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Test and the Seed</h2>
    </hgroup>
    <article>
      <p>The seed ships with the necessary dependencies to test With REST-Assured, and provides a demo that shows how to
        start an
        in-memory Tomcat Instance for your tests</p>
      <p style="font-weight: bold">Testing REST Services that requires Authentication</p>
      <div style="border:solid 1px slategray;width:100%;height:6px;background-color: slategray;margin-bottom: 20px;">
        &nbsp;</div>
      <div style="float:left;width:20%"><img style="width:85%" src="../images/Demo.png"></div>
      <div style="float: left;font-size: 80%;width: 80%;">
        <ol>
          <li><p>Run the seed from NetBeans, and open <em>Chrome Developer Tools</em> &rightarrow; <em>Network-tab</em>
            in the browser</p></li>
          <li><p>Login (as <em>user_admin</em>) and observe the JSON provided with the request and the JSON returned
            with the response</p></li>
          <li><p>Navigate to one of the protected pages, and observe (in the headers) what is being sent (automatically)
            with the request</p></li>
          <li><p>Now, open POSTMAN and login (repeating what you observed in step-1)</p></li>
          <li><p>Use the TOKEN returned to perform a GET request up against a protected Service (using what you observed
            in step-2</p></li>
          <li><p style="font-weight: bold">Open the file <code>test. InitialSeedRestIntegrationTest</code> and observe
            how the exact same thing is done, using REST-assured</p></li>
        </ol>
      </div>

    </article>
  </slide>

  <slide>
    <hgroup><h2>The Semester Seed</h2></hgroup>
    <h3>How do I protect my REST services?</h3>
    <br/>
    <p>You can use the following <a
            href="https://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/twbs_jaxrs_impl_securejaxrs_annotations.html">annotations</a>
      to add authorization semantics to your JAX-RS application
      resources:</p>
    <br/>
    <p><b>@PermitAll</b></p>
    <p>Specifies that all security roles are permitted to access your JAX-RS resources</p>
    <br/>
    <p><b>@DenyAll</b></p>
    <p>Specifies that no security roles are permitted to access your JAX-RS resources</p>
    </br>
    <p><b>@RolesAllowed</b></p>
    <p>Specifies the security roles that are permitted to access your JAX-RS resources</p>
    <br/>

    <div style="border:solid 1px slategray;width:100%;height:6px;background-color: slategray;margin-bottom: 10px;">
      &nbsp;</div>
    <div style="float:left;width:20%"><img style="width:65%" src="../images/Demo.png"></div>
    <div style="float: left;font-size: 80%;width: 80%;">
      <br/>
      Locate the code for the two "protected" services and observe how the annotations are used in the seed
    </div>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Adding a "database" to the seed</h2>
    </hgroup>
    <article>
      <ul>
        <li>As you probably have noticed, the default users and passwords are hardcoded into a Map in the seed</li>
        <li>Obviously this will never work for a reallife application, so your task today is, to change the seed into a
          version including <em>users</em> and <em>roles</em> handleded by Entity classes
        </li>
        <li>It will then be up to each project, using the seed, to decide for, which database to use (via the
          persistence.xml file)
        </li>
      </ul>
      <br>
      <div style="font-size: larger">But first a (very important) bit about how to handle user-passwords</div>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Handling Passwords</h2>
    </hgroup>
    <article>

      <div style="margin-left: 18em;margin-top: -80px;">
        <img src="images/passwords.jpg" style="width:45%;">
      </div>
      <p>Why is it such a bad idea to store passwords in plaintext on our backend, assuming our backend is
        "secure" ??</p>
      <div class="build">
        <p>Can you (always) trust all people with (full) access to the database</p>
        <p>Can you (as probably the only company on earth) guarantee that you will never be (or is)
          hacked</p>
        <p>Users (very) often reuse their passwords across different sites. So even if you think it's not a big
          deal, it
          could be a very BIG deal for your users</p>
        <br/>

        <p><b>The following will give you a quick introduction to how to solve this problem</b></p>
      </div>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>First a little bit of theory</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/hash1.jpg">

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>One Way Hash Functions</h3>
    </hgroup>
    <article class="flexbox vcenter">
      <p style="margin-top: -35px;">
        A one-way hash function is an algorithm that turns messages or text into a fixed string of digits,
        called the
        Cryptographic hash value or the Digest).</p>

      <p>
        One way indicates that it's (almost) impossible to derive the original text given the digest
      </p>
      <img src="images/OneWayHash.png" style="width: 90%;">

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>Hashing Passwords - 1</h3>
    </hgroup>
    <article class="flexbox vcenter">

      <img src="images/hashingPasswords1.PNG" style="width: 80%;margin-left: 10%;margin-top: -75px;">

    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>Hashing Passwords - 2</h3>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/hashingPasswords2.PNG" style="width: 90%;margin-left: 5%;margin-top: -75px;">
    </article>
  </slide>


  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>Dictionary Attacks</h3>
    </hgroup>
    <article>
      <img src="images/DictionaryAttack.PNG" style="">

      <p style="margin-top: 15px;"><a href="https://www.youtube.com/watch?v=O6cmuiTBZVs">Watch this Fantastic (6
        min only) video</a>, and you will never ever consider storing your passwords in plaintext</p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>Hashing Passwords - 3</h3>
    </hgroup>
    <article>
      <h3 style="margin-top: -35px;color: #000066">So, does using a secure one-way hash function provide enough
        security?
      </h3>

      <p>Using this link <a href="https://crackstation.net/">https://crackstation.net/</a> se how long time it
        takes to
        crack the string:</p>

      <p>3f21a8490cef2bfb60a9702e9d2ddb7a805c9bd1a263557dfd51a7d0e9dfa93e <em style="color: #000088">
      </em>
      </p>

      <p>After that go to Wikipedia, chose any language (Suomi for example), perform a search and pick a random
        word,
        generate the Digest, and see whether it can be “broken”
      </p>

      <h3 style="color: #000066">The answer to the question must be NO! </h3>
    </article>
  </slide>
  <slide>
    <hgroup>
      <h2>Cryptographic Hashes</h2>

      <h3>Hashing Passwords - 4</h3>
    </hgroup>
    <article style="margin-top: 0px;">
      <h3 style="color: #000066;">We need to add some salt</h3>
      <div class="flexbox vcenter">
        <img src="images/password_hashingWithSALT.png">
      </div>

      <p style="font-size: 0.8em; margin-top: 20px;">Read/skim the link below to get the details about one-way
        hashing
        and why "salting" is necessary
      </p>

      <p>
        <a href="https://crackstation.net/hashing-security.htm">https://crackstation.net/hashing-security.htm"</a>
      </p>
    </article>
  </slide>


  <slide>
    <hgroup>
      <h2>Hashing Passwords with the seed</h2>
    </hgroup>
    <article>
      <p>See Exercise for today </p>

    </article>
  </slide>


  <slide class="backdrop"></slide>

</slides>

<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXXXX-1']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
  })();
</script>

<!--[if IE]>
<script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
<script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
